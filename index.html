<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Scratch HTML5</title>

    <!-- iPad properties: set width, disable pinch zoom -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="user-scalable=no, width=540">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div id="player-container"></div>

    <div id="project-picker">
        <span id="address-hint">http://scratch.mit.edu/projects/</span><input id="project-id" placeholder="10000160"><button id="go-project">&rarr;</button>
    </div>

    <h1>Scratch HTML5 player</h1>
    <p>The Scratch HTML5 player is still in development. Feedback is welcome! Please report any bugs (or differences from the Flash player) <a href="https://github.com/LLK/scratch-html5">on Github</a>.</p>

    <script type="text/JavaScript" src="Scratch.js"></script>
    <script type="text/JavaScript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">
        $(function() {
            var project_id = location.hash && parseInt(location.hash.substr(1)) || 10000160;
            var address = $('#address-hint');
            var project = $('#project-id');

            // Update the project ID field
            project.val(project_id);

            // Validate project ID field
            project.keyup(function() {
                var n = this.value;

                // Allow URL pasting
                var e = /projects\/(\d+)/.exec(n);
                if (e) {
                    n = this.value = e[1];
                }

                // Eventually, this will xhr to /projects/{{this.value}}/ and
                // change color based on whether the response is 404 or 200.
                $('#project-id, #address-hint').toggleClass('error', isNaN(n));
            });

            // Focus the actual input when the user clicks on the URL hint
            address.click(function() {
                project.select();
            });

            var width = address.outerWidth();
            project.css({
                paddingLeft: width,
                marginLeft: -width
            });

            // Go project button behavior
            $('#go-project').click(function() {
                window.location = '#' + parseInt($('#project-id').val());
                window.location.reload(true);
            });

            Scratch.create({ container: '#player-container', projectId: project_id });
        });
    </script>
</body>
</html>
